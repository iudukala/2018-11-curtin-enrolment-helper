<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>eTracker - Planner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--{% block link %}
    {% load staticfiles %}-->
    <link rel="stylesheet" href="static/core_app/css/planner.css"/>
    <script src="static/core_app/js/angular.min.js"></script>
    <script src="static/core_app/js/student_select.js"></script>
    <script src="static/core_app/js/planner.js"></script>
    <!--{% endblock %}-->
</head>

<body ng-app="plannerApp" ng-class="{'invisible': loaded}">
  <div class="spinner-overlay" ng-class="{'spinner-overlay-disappeared' : !loading}">
    <div class="spinner-prompt">
      <div class="spinner-image"></div>
      <span class="spinner-message">{[{ loadingMessage }]}</span>
    </div>
  </div>
  <div class="content-wrapper student-select-wrapper"
       ng-controller="studentSelectCtrl"
       ng-class="{ 'hidden-student-select': !selectingStudent }">
    <!--Student Selector Title-->
    <div class="header-wrapper">
      <h1>STUDENT SELECT</h1>
    </div>

    <!--Student selector-->
    <div class="student-selector">
      <span id="selector-error-text" ng-class="{'selector-error-text-invisible': !errorMessage}"> {[{errorText}]} </span>
      <input type="text" class="subtle-input" placeholder="Search..." ng-model="searchText">
      <div class="student-table-header">
        <div class="cell student-name-cell">Name</div>
        <div class="cell student-id-cell">Student ID</div>
      </div>
      <ul class="student-name-table">
        <li class="student-table-row"
            ng-repeat="student in students | filter:searchText"
            ng-class="{'row-selected': (selectedStudent.id === student.id)}"
            ng-click="selectStudent(student.id, student.name)">
          <div class="cell student-name-cell">{[{ student.name }]}</div>
          <div class="cell student-id-cell">{[{ student.id }]}</div>
        </li>
      </ul>
      <input type="button"
             class="button"
             value="EDIT PLAN"
             id="edit-plan"
             ng-class="{ 'button-disabled' : studentIsEmpty() || gettingStudentTemplate }"
             ng-click="!studentIsEmpty() && gotoPlanner()">
      <div class="button-bottom">
        <a href="{% url 'core_app:home' %}" class="button-logout">&#60; HOME</a>
      </div>
    </div>
  </div>
  <div class="content-wrapper student-planner-wrapper"
       ng-controller="plannerCtrl"
       ng-class="{ 'hidden-planner': selectingStudent }">

    <!--Planner Title-->
    <div class="header-wrapper">
      <h1>{[{ theStudent.name.toUpperCase() }]}</h1>
    </div>

    <div class="planner-widget-wrapper">
      <span class="course-name-label">{[{ theJSON.course.name }]}</span>
      <!--Template Table-->
      <div class="template-table" id="template-table">
        <ul class="template-year-list"> <!--List of years-->
          <li class="template-year-wrapper" ng-repeat="year in theTemplate" ng-init="parentIndex = $index">
            <ul class="template-sem-list"> <!--List of semesters-->
              <li ng-repeat="sem in year">
                <ul class="template-unit-list"><!--List of blocks per semester-->
                  <li class="template-header-cell">
                    <div>Y{[{ $parent.$index + 1 }]} S{[{ $index + 1 }]}</div>
                  </li>
                  <li class="template-unit-cell" ng-style="templateCellStyle(unit.status, unit.credits)" ng-repeat="unit in sem">
                    <div>
                      <span class="unit-id" class="unit-id">{[{ unit.id }]}</span>
                      <span class="unit-subtext">Credits: {[{ unit.credits | number : 1 }]}</span>
                      <span class="unit-subtext">{[{ getUnitAttemptsText(unit.attempts, unit.status) }]}</span>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>

      <!--Planner Table-->
      <div class="planner-table">
        <div class="semester-heading-adder">
          <label for=sem-header-year-input>Year:</label>
          <input id="sem-header-year-input" maxlength="1" type="text" ng-model="semHeaderYearInput">
          <label for=sem-header-year-input>Semester:</label>
          <input id="sem-header-sem-input" maxlength="1" type="text" ng-model="semHeaderSemInput">
          <div class="add-sem-header-button" ng-click="addSemHeader()">+</div>
        </div>
        <ul>
          <li ng-repeat="year in thePlan">
            <ul>
              <li ng-repeat="sem in year">
                <ul>
                  <li ng-repeat="unit in sem">
                    {[{ renderPlannerRow(unit) }]}
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <div class="button-bottom">
      <a href="#"
         class="button-logout"
         ng-click="backToStudents()">&#60; STUDENT SELECT</a>
    </div>
  </div>
</body>
</html>
